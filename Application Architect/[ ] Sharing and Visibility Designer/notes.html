<!DOCTYPE html>
<html lang="en_US">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../utilities/bootstrap-4.0.0-alpha.6-dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/style.css" />
</head>

<body>
    <div class="container">
        <div class="card ">
            <div class="card-block bg-faded">
                <div class="row">
                    <div class="col-sm-10">
                        <h1 class="card-title">
                            Sharing and Visibility Designer Notes
                        </h1>
                    </div>
                    <div class="col">
                        <a href="http://certification.salesforce.com/open-a-case" title="Request a Training Org" target="_blank">
                    <img src="../../utilities/icons/glyphicons/png/glyphicons-142-database-plus.png" alt="" height="20px" width="20px">
                    </a>
                    </div>
                </div>
                <hr style="border: 0;border-top: 3px double #8c8c8c;" />
                <h3>
                    Key Terms, Phrases, or Ideas
                </h3>
                <ol class="no-nest">
                    <li>
                        Data access begins with a user.
                        <emoji-rain active></emoji-rain>
                    </li>
                    <li>
                        Record ownership and full access are synonymous and interchangeable and provide the user with the highest level of access to a record.
                    </li>
                    <li>
                        Every record must be owned by a single user or a queue.
                    </li>
                    <li>
                        Users higher in a hierarchy (role or territory) inherit the same data access as their subordinates for standard objects.
                    </li>
                    <li>
                        Organization-wide defaults are the <b>only</b> way to restrict user access to a record.
                    </li>
                    <li>
                        Contact ownership-based <b>sharing rules don't apply</b> to private contacts.
                    </li>
                    <li>
                        Only manual share records can be created on standard objects. (Cannot use Apex sharing reasons, but Manual shares can be created with Apex)
                    </li>
                    <li>
                        The team object is not a first-class object. You can't create custom fields, validations rules, or triggers for teams.
                    </li>
                    <li>
                        Territories exist only on Account, Opportunity and master/detail children of Accounts and Opportunities.
                    </li>
                    <li>
                        The only users that can add, edit or delete sharing records created by Apex managed sharing are users with the "Modify All Data" permission.
                    </li>
                </ol>
                <h3>
                    Best Practices
                </h3>
                <ol>
                    <li>
                        If a single user owns more than 10,000 records
                        <ul>
                            <li>
                                The user record of the owner should not hold a role in the role hierarchy.
                            </li>
                            <li>
                                If the owner's user record must hold a role, the role should be at the top of the hierarchy in its own branch of the role hierarchy.
                            </li>
                        </ul>
                    </li>
                    <li>
                        Keep the number of non-portal roles to 25,000 and the number of portal roles to 100,000
                    </li>
                    <li>
                        Keep the role hierarchy to no more than 10 levels of branches in the hierarchy.
                    </li>
                    <li>
                        Keep the total number of public groups for an organization to 100,000.
                    </li>
                    <li>
                        Don't nest groups more than five levels.
                    </li>
                    <li>
                        Keep the number of ownership-based sharing rules per object to 1,000.
                    </li>
                    <li>
                        Keep the number of criteria-sharing rules per object to 50; however, this can be increased by Salesforce.
                    </li>
                    <li>
                        Keep the territory hierarchy to no more than 10 levels of branches in the hierarchy.
                    </li>
                </ol>
                <h3>
                    Questions / Clarity Needed
                </h3>
                <ol>
                    <li>
                        A Guide to Sharing Architecture
                        <ul>
                            <li>
                                <b>Q:</b> On page 3 under the Role Hierarchy section, paragraph 6 mentions Overlays. What is an overlay?
                                <br/>
                                <b>A:</b> ex. A person in Service needs to be able to see some Sales data, but they live in different branches of the hierarchy.
                            </li>
                            <li>
                                <b>Q:</b> Multiple owners of an account?
                                <br/>
                                <b>A:</b>
                            </li>
                        </ul>
                    </li>
                </ol>
                <br />
                <h3>
                    Follow ups or Proofs Needed                
                </h3>
                <ol>
                    <li>
                        A Guide to Sharing Architecture
                        <ul>
                            <li>
                                A Guide to Sharing Architecture states that manual shares can be viewed and edited and deleted via the "Sharing" button on the record. I want to test whether or not share records for Apex sharing reasons can be edited or removed from that button also.
                            </li>
                            <li>
                                A Guide to Sharing Architecture states that a potential use case for role hierarchy is to ensure managers can see and do everything that their subordinates can see and do. I want to test if that use case can be blocked by the manager's profile if it is more restrictive in a CRUD or FLS sense. e.x. If manager's profile has read only on account and subordinates profile has read/write, will the inherited access allow the manager to read/write. Not a realistic scenario but a good scenario to test the access that is inherited. I suspect the manager's profile will ensure the manager cannot edit, but am curious because when two sharing/access rules are compared, the least restrictive wins.
                            </li>
                        </ul>
                    </li>
                    <li>
                        General Salesforce Knowledge
                        <ul>
                            <li>
                                Review Territory Management
                            </li>
                        </ul>
                    </li>
                </ol>
                <h3>
                    External Sources
                </h3>
                <ol>
                    <li>
                        <a href="https://developer.salesforce.com/blogs/engineering/2013/10/behind-the-scenes-of-record-ownership-in-salesforce.html" target="_blank">
                            Behind the scenes of record ownership
                        </a>
                    </li>
                    <li>
                        <a href="https://developer.salesforce.com/page/Using_Apex_Managed_Sharing_to_Create_Custom_Record_Sharing_Logic" target="_blank">
                            Using Apex Managed Sharing to Create Custom Record Sharing Logic
                        </a>
                    </li>
                    <li>
                        <a href="https://quizlet.com/222316220/salesforce-certified-sharing-and-visibility-designer-all-combined-flash-cards/" target="_blank">
                            Quizlet Flashcards (Quality Unknown)
                        </a>
                    </li>
                    <li>
                        <a href="https://help.salesforce.com/articleView?id=security_owd_external.htm&type=5" target="_blank">
                            External Org-Wide Defaults Overview
                        </a>
                    </li>
                    <li>
                        <a href="https://help.salesforce.com/articleView?id=users_managers_only.htm&type=0" target="_blank">
                            Sharing Records with Manager Groups
                        </a>
                    </li>
                </ol>
                <br />
                <h2>
                    <a href="files/sharing_architecture.pdf" download>
                        A Guide to Sharing Architecture
                    </a>
                </h2>
                <hr/>
                <h3>
                    Data Access Mechanisms
                </h3>
                <ol>
                    <li>
                        License Types
                        <ul>
                            <li>
                                Full Sharing Model Usage Users/Licenses
                                <ul>
                                    <li>
                                        Allows access to all sharing components regardless of edition.
                                    </li>
                                </ul>
                            </li>
                            <li>
                                High Volume Portal Users
                                <ul>
                                    <li>
                                        Do not have access to standard sharing model.
                                    </li>
                                    <li>
                                        Has a completely different sharing model based on foreign key match between portal user and the data on the associated account and contact lookups.
                                    </li>
                                    <li>
                                        HVPU license is only used for the Customer Portal and not the Partner Portal.
                                    </li>
                                </ul>
                            </li>
                            <li>
                                Chatter Free Users
                                <ul>
                                    <li>
                                        Do not have access to standard sharing model.
                                    </li>
                                    <li>
                                        Chatter Free is a collaboration-only license with the following features: Chatter, Profile, People, Groups, Files, Chatter Desktop, and limited Salesforce1 app access.
                                    </li>
                                    <li>
                                        Does NOT have access to any salesforce records, thus, no need for sharing model.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ol>
                <h3>
                    Components
                </h3>
                <img src="images/sharing overview.png" />
                <ol>
                    <li>
                        Profiles and Permission Sets
                        <ul>
                            <li>
                                Object level security
                            </li>
                            <li>
                                CRUD
                            </li>
                            <li>
                                FLS
                            </li>
                        </ul>
                    </li>
                    <li>
                        Record Ownership and Queues
                        <ul>
                            <li>
                                Every record must be owned by a single user or a queue.
                            </li>
                            <li>
                                The owner has access to the record, based on the Object Settings for the owner’s profile.
                            </li>
                            <li>
                                Queues help you prioritize, distribute, and assign records to teams who share workloads.
                            </li>
                        </ul>
                    </li>
                    <li>
                        Organization-Wide Defaults
                        <ul>
                            <li>
                                Organization-wide sharing settings specify the default level of access users have to each others’ records.
                            </li>
                            <li>
                                You use organization-wide sharing settings to lock down your data to the most restrictive level, and then use the other record-level security and sharing tools to selectively give access to other users.
                            </li>
                        </ul>
                    </li>
                    <li>
                        Role Hierarchy
                        <ul>
                            <li>
                                The role hierarchy ensures that managers always have access to the same data as their employees, regardless of the organization-wide default settings.
                            </li>
                            <li>
                                Role hierarchies don't have to match your organization chart exactly. Instead, each role in the hierarchy should represent a level of data access that a user or group of users needs.
                            </li>
                            <li>
                                Use Cases for Role hierarchy:
                                <ul>
                                    <li>
                                        <u>Management access</u> – the ability for managers to be able to see and do whatever their subordinates can see and do.
                                    </li>
                                    <li>
                                        <u>Management reporting</u> – the ability for reporting to roll up in a hierarchical fashion so that anyone higher in the hierarchy sees more data than those below them.
                                    </li>
                                    <li>
                                        <u>Segregation between organizational branches</u> – different business units don’t need to see each other’s data; having a hierarchy in which you can define separate branches allows you to segregate visibility within business units, while still rolling visibility up to the executive levels above those units.
                                    </li>
                                    <li>
                                        <u>Segregation within a role</u> – in many organizations/applications, people who all play the same role should not necessarily see each other’s data. Having hierarchical roles allows you to define a “leaf” node in which all data is essentially private, and still roll that data up to a parent role that can see all.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Public Groups
                        <ul>
                            <li>
                                A public group (not Chatter group) is a collection of individual users, roles, territories, and so on, that all have a function in common.
                            </li>
                            <li>
                                Public groups can consist of:
                                <ul>
                                    <li>
                                        Users
                                    </li>
                                    <li>
                                        Customer Portal Users
                                    </li>
                                    <li>
                                        Partner Users
                                    </li>
                                    <li>
                                        Roles
                                    </li>
                                    <li>
                                        Roles and Internal Subordinates
                                    </li>
                                    <li>
                                        Roles, Internal and Portal Subordinates
                                    </li>
                                    <li>
                                        Portal Roles
                                    </li>
                                    <li>
                                        Portal Roles and Subordinates
                                    </li>
                                    <li>
                                        Territories
                                    </li>
                                    <li>
                                        Territories and Subordinates
                                    </li>
                                    <li>
                                        Other public groups (nesting)
                                    </li>
                                </ul>
                            </li>
                            <li>
                                Public Group Use Cases:
                                <ul>
                                    <li>
                                        When you need to provide access to an arbitrary group of people, you create a public group to collect them, and then use other sharing tools to give the group the necessary access. Group membership alone doesn't provide data access.
                                    </li>
                                    <li>
                                        Groups can also be nested inside each other, therefore, allowing a nested group to gain the same access as the group in which it is contained. This allows the creation of smaller, ad-hoc hierarchies that don’t necessarily interact with the role or territory hierarchies. If Group A is a member of Group B, then the members of Group A will have access to data shared to Group B at the same access level as the members of Group B.
                                    </li>
                                    <li>
                                        Groups also have the ability to protect data shared in the group from being made accessible to people in the role hierarchy above the group members. This (and dealing with the access of record owners and their management hierarchy) allows the creation of groups in which very highly confidential information can be shared—the data will be accessible ONLY to group members, and nobody else in the organization. This is accomplished by using the Grant Access Using Hierarchies setting.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Ownership-based Sharing Rules
                        <ul>
                            <li>
                                Ownership-based sharing rules allow for exceptions to organization-wide default settings and the role hierarchy that give additional users access to records they don’t own.
                            </li>
                            <li>
                                Ownership-based Sharing Rule Use Cases:
                                <ul>
                                    <li>
                                        Role-based matrix management or overlay situations: a person in Service needs to be able to see some Sales data, but they live in different branches of the hierarchy, so you can create a rule that shares data between roles on different branches.
                                    </li>
                                    <li>
                                        To provide data access to peers who hold the same role/territory. (Lateral)
                                    </li>
                                    <li>
                                        To provide data access to other groupings of users (public groups, portal. roles, territories). The members of the groupings who own the records can be shared with the members of other groupings.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Criteria-based Sharing Rules
                        <ul>
                            <li>
                                Criteria-based sharing rules provide access to records based on the record’s field values (criteria). If the criteria are met (one or many field values), then a share record is created for the rule. Record ownership is not a consideration.
                            </li>
                            <li>
                                Criteria-based Sharing Rule Use Case
                                <ul>
                                    <li>
                                        To provide data access to users or groups based on the value of a field on the record.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Manual Sharing
                        <ul>
                            <li>
                                Sometimes it’s impossible to define a consistent group of users who need access to a particular set of records. In those situations, record owners can use manual sharing to give read and edit permissions to users who would not have access to the record any other way. Although manual sharing isn’t automated like organization-wide sharing settings, role hierarchies, or sharing rules, it gives record owners the flexibility to share particular records with users that need to see them.
                            </li>
                            <li>
                                Manual sharing is removed when the record owner changes or when the sharing access granted doesn't grant additional access beyond the object's organization-wide sharing default access level. This also applies to manual shares created programmatically.
                            </li>
                            <li>
                                All share records (standard and custom objects) with a row cause set to manual share can be edited and deleted by the Share button on the object's page layout, even if the share record was created programmatically.
                            </li>
                            <li>
                                Manual Sharing Use Case
                                <ul>
                                    <li>
                                        To provide the user with the ability to give access (read only or read/write) to the current record to other users, groups, or roles.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Teams
                        <ul>
                            <li>
                                A team is a group of users that work together on an account, sales opportunity, or case.
                            </li>
                            <li>
                                Record owners can build a team for each record that they own. The record owner adds team members and specifies the access level each team member has to the record.
                            </li>
                            <li>
                                Some team members can have read-only access, while others have read/write.
                            </li>
                            <li>
                                Only owners, people higher in the hierarchy, and administrators can add team members and provide more access to the member.
                            </li>
                            <li>
                                A team member with read/write access can add another member who already has access to the record with which the team is associated. <b>The team member can't provide them additional access.</b>
                            </li>
                            <li>
                                Creating a team member in the app creates two records: a team record and an associated share record.
                            </li>
                            <li>
                                If you create team members programmatically, you have to manage both the team record and associated share record. There is only one team per record (Account, Opportunity or Case). If multiple teams are needed, depending on your specific needs consider territory management or programmatic sharing.
                            </li>
                            <li>
                                Teams (Account and Opportunity) Use Cases:
                                <ul>
                                    <li>
                                        To provide the user with the ability to give access (read-only or read/write) to a single group of users (the team).
                                    </li>
                                    <li>
                                        If teams are managed externally, say through an external commission or territory management system, then integration can be used to manage the account team. There are cases when territory management in an external system can align to a team solution within Salesforce.
                                    </li>
                                    <li>
                                        Multiple owners of an account can be managed by the account team.
                                    </li>
                                    <li>
                                        A single group of users (team) require either read-only or read/write access to an opportunity record. (Opportunity Team)
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Territory Hierarchy
                        <ul>
                            <li>
                                The territory hierarchy is a single dimensional, additional hierarchy which can be structured by business units or any kind of segmentation in a hierarchical structure.
                            </li>
                            <li>
                                When territory management is enabled you must manage both the role hierarchy and territory hierarchy.
                            </li>
                            <li>
                                If the assignment rules for a territory are changed, any Account Territory sharing rules using that territory as the source will be recalculated. Likewise, if the membership of a territory changes, any ownership-based sharing rules that use the territory as the source will be recalculated.
                            </li>
                            <li>
                                Territory Management Use Cases
                                <ul>
                                    <li>
                                        Multiple groups of people (multiple teams) require either read-only or read/write access to accounts
                                    </li>
                                    <li>
                                        An additional hierarchical structure (different from the role hierarchy) is needed.
                                    </li>
                                    <li>
                                        A single user needs to hold multiple levels in the hierarchy.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Account Territory Sharing Rules
                        <ul>
                            <li>
                                Account territory sharing rules become available only when Territory Management has been enabled for an organization. These sharing rules provide access to Account records that have been stamped with the Territory defined in the rule.
                            </li>
                            <li>
                                Account Territory Sharing Rule Use Case
                                <ul>
                                    <li>
                                        To provide data access to accounts within a territory (not based on ownership) to a grouping of users. Applies only to accounts and when territory management is enabled.
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Programmatic Sharing
                        <ul>
                            <li>
                                Programmatic sharing (formally Apex-managed sharing) allows you to use code (Apex or other) to build sophisticated and dynamic sharing settings when a data access requirement cannot be met by any other means.
                            </li>
                            <li>
                                If you create a share record programmatically, and the out-of-box row cause (manual share) is used, then you can maintain this share record with the Share button in the app. The share record is subject to all rules with the manual share row cause such as deletion upon owner transfer.
                            </li>
                        </ul>
                    </li>
                    <li>
                        Implicit Sharing
                        <ul>
                            <li>
                            </li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>
    </div>
</body>

</html>